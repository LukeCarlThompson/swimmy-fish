var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,i=(e,t)=>{for(var o in t||(t={}))n.call(t,o)&&s(e,o,t[o]);if(r)for(var o of r(t))a.call(t,o)&&s(e,o,t[o]);return e};import{c as l,u as c,r as m,V as d,a as u,R as p,b as h,S as y,P as E,d as g,s as v,C as f,e as w,f as k}from"./vendor.3cc97305.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const b=l((e=>({position:[0,0,0],velocity:[0,0,0],rotation:[0,0,0],setVelocity:t=>e({velocity:t}),increaseVelocityUp:()=>e((e=>({velocity:[e.velocity[0],e.velocity[1]+1,e.velocity[2]]}))),stopVelocity:()=>e({velocity:[0,0,0]})}))),P=e=>e*(Math.PI/180),M=e=>e/(1+Math.abs(e)),C=e=>{const t=m.exports.useRef();return new d,u((e=>{const[o,r,n]=b.getState().velocity;t.current.rotation.set(0,35*P(Math.sin(.5*(r+o)+2*e.clock.getElapsedTime())),0)})),p.createElement("group",{ref:t,position:[-1,0,0]},p.createElement(h,{args:[.6,.6,.2],position:[-.2,0,0],radius:.05,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{args:[.75,.4,.1],position:[-.6,.15,0],radius:.05,smoothness:2,rotation:[0,0,-10]},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{args:[.75,.4,.1],position:[-.6,-.15,0],radius:.05,smoothness:2,rotation:[0,0,10]},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})))},L=e=>{const r=m.exports.useRef(),n=new d;return u((t=>{const[o,a,s]=b.getState().velocity,i=n.lerp(n.set(M(-.1*a),.1*M(-1*a)+.5,0),.25);r.current.setRotationFromAxisAngle(i.normalize(),e.mirror?-10:.5)})),p.createElement("group",(a=i({},e),t(a,o({ref:r}))),p.createElement(y,{position:[0,0,0],args:[.3]},p.createElement("meshPhongMaterial",{attach:"material",color:"#f3f3f3"})),p.createElement(y,{position:[0,0,.25],args:[.1]},p.createElement("meshPhongMaterial",{translate:[0,10,.25],attach:"material",color:"black"})));var a},S=e=>{const[t,o]=c((()=>i({mass:1,position:[0,5,0]},e))),r=m.exports.useRef(),n=m.exports.useRef(),a=new d;return console.log("Player"),m.exports.useEffect((()=>{const e=o.velocity.subscribe((e=>{b.setState({velocity:e})})),t=o.position.subscribe((e=>{b.setState({position:e})})),r=o.rotation.subscribe((e=>{b.setState({rotation:e})}));return()=>{e(),t(),r()}}),[]),u((t=>{const[s,i,l]=b.getState().velocity;e.up&&o.velocity.set(s,i+1,l),e.down&&o.velocity.set(s,i-1,l),e.right&&o.velocity.set(s+1,i,l),e.left&&o.velocity.set(s-1,i,l);const c=-10*Math.sin(.5*(i+s)+2*t.clock.getElapsedTime()),m=a.lerp(a.set(0,P(180*(.5*M(s)-.5)+c),P(45*M(i/10))),.1);o.rotation.set(0,m.y,m.z),r.current.setRotationFromAxisAngle(a.lerp(a.set(M(.5*i),-.8,0),.25),.5),n.current.setRotationFromAxisAngle(a.lerp(a.set(-1*M(.5*i),.8,0),.25),.5)})),p.createElement("group",{ref:t},p.createElement(h,{args:[1.5,1.2,.8],position:[.25,.1,0],radius:.2,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{args:[1,.75,.6],position:[-.5,.05,0],radius:.2,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{args:[.7,.5,.8],position:[.8,-.25,0],rotation:[0,0,0],radius:.1,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{args:[.5,.5,.05],position:[.25,.7,0],radius:.05,smoothness:2,rotation:[0,0,10]},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{ref:r,args:[.5,.1,.6],position:[-0,-.25,.4],radius:.05,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{ref:n,args:[.5,.1,.6],position:[-0,-.25,-.4],radius:.05,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),p.createElement(h,{args:[.1,.1,.5],position:[1.15,-.4,0],radius:.05,smoothness:2},p.createElement("meshPhongMaterial",{attach:"material",color:"black"})),p.createElement(L,{position:[.6,.1,.35]}),p.createElement(L,{position:[.6,.1,-.35],mirror:!0}),p.createElement(C,{color:e.color}))},x=e=>{const[t]=g((()=>i({rotation:[-Math.PI/2,0,0],position:[0,-20,0]},e)));return p.createElement("mesh",{ref:t,receiveShadow:!0},p.createElement("planeBufferGeometry",{attach:"geometry",args:[1009,1e3]}),p.createElement("shadowMaterial",{attach:"material",color:"#171717"}),p.createElement("meshStandardMaterial",{color:"#4bb3fd"}))},O=e=>{const[t,o]=m.exports.useState(!1),[r,n]=m.exports.useState(!1),[a,s]=m.exports.useState(!1),[i,l]=m.exports.useState(!1);return console.log("Scene"),m.exports.useEffect((()=>{const e=e=>{38===e.keyCode||87===e.keyCode||32===e.keyCode?o(!0):37===e.keyCode||65===e.keyCode?s(!0):39===e.keyCode||68===e.keyCode?l(!0):40===e.keyCode||83===e.keyCode?n(!0):e.keyCode},t=e=>{38===e.keyCode||87===e.keyCode||32===e.keyCode?(console.log("up keyup"),o(!1)):37===e.keyCode||65===e.keyCode?s(!1):39===e.keyCode||68===e.keyCode?l(!1):40===e.keyCode||83===e.keyCode?n(!1):e.keyCode},r=()=>{o(!0)},a=()=>{o(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),window.addEventListener("mousedown",r),window.addEventListener("mouseup",a),window.addEventListener("touchstart",r),window.addEventListener("touchend",a),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),window.removeEventListener("mousedown",r),window.removeEventListener("mouseup",a),window.removeEventListener("touchstart",r),window.removeEventListener("touchend",a)}}),[]),p.createElement(p.Fragment,null,p.createElement("pointLight",{position:[10,10,-10],decay:10,intensity:2}),p.createElement(E,{gravity:[0,-10,0],tolerance:.1},p.createElement(S,{color:"red",up:t,down:r,left:a,right:i}),p.createElement(x,null)))},j=v.div`
  width: 100vw;
  height: 100vh;
`,A=()=>{const e=new d;return console.log("Camera movement"),u((t=>{const[o,r,n]=b.getState().position,a=e.lerp(e.set(o,r,n),.05);t.camera.lookAt(a),t.camera.position.x=a.x,t.camera.position.z=30,t.camera.updateProjectionMatrix()})),null},R=()=>(console.log("Scene mounted"),p.createElement(j,null,p.createElement(f,{shadows:!0,colorManagement:!0,camera:{position:[4.5,-10,50],fov:35,far:300,near:.1}},p.createElement("ambientLight",null),p.createElement("pointLight",{position:[10,10,10]}),p.createElement(O,null),p.createElement(w,{azimuth:.1,turbidity:5,rayleigh:0,inclination:.6,sunPosition:[.1,0,-5],distance:1e4}),p.createElement(A,null))));k.render(p.createElement(p.StrictMode,null,p.createElement(R,null)),document.getElementById("root"));
