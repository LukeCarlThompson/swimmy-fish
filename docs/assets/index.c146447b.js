var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,s=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&l(e,o,t[o]);if(r)for(var o of r(t))n.call(t,o)&&l(e,o,t[o]);return e};import{c as i,u as c,r as m,V as u,a as p,R as d,b as h,S as y,P as g,d as E,s as f,C as v,O as k,e as b,f as w}from"./vendor.80846c4c.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const P=i((e=>({position:[0,0,0],velocity:[0,0,0],setVelocity:t=>e({velocity:t}),increaseVelocityUp:()=>e((e=>({velocity:[e.velocity[0],e.velocity[1]+1,e.velocity[2]]}))),stopVelocity:()=>e({velocity:[0,0,0]})}))),M=e=>e*(Math.PI/180),C=e=>e/(1+Math.abs(e)),S=e=>{const t=m.exports.useRef();return new u,p((e=>{const[o,r,a]=P.getState().velocity;t.current.rotation.set(0,35*M(Math.sin(.5*r+2*e.clock.getElapsedTime())),0)})),d.createElement("group",{ref:t,position:[-1,0,0]},d.createElement(h,{args:[.6,.6,.2],position:[-.2,0,0],radius:.05,smoothness:4},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{args:[.75,.4,.1],position:[-.6,.15,0],radius:.05,smoothness:4,rotation:[0,0,-10]},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{args:[.75,.4,.1],position:[-.6,-.15,0],radius:.05,smoothness:4,rotation:[0,0,10]},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})))},x=e=>{const r=m.exports.useRef(),a=new u;return p((t=>{const[o,n,l]=P.getState().velocity,s=a.lerp(a.set(C(-.1*n),.1*C(-1*n)+.5,0),.25);r.current.setRotationFromAxisAngle(s.normalize(),e.mirror?-10:.5)})),d.createElement("group",(n=s({},e),t(n,o({ref:r}))),d.createElement(y,{position:[0,0,0],args:[.3]},d.createElement("meshPhongMaterial",{attach:"material",color:"#f3f3f3"})),d.createElement(y,{position:[0,0,.25],args:[.1]},d.createElement("meshPhongMaterial",{translate:[0,10,.25],attach:"material",color:"black"})));var n},L=e=>{const[t,o]=c((()=>s({mass:1,position:[0,5,0]},e))),r=m.exports.useRef(),a=m.exports.useRef(),n=new u;return console.log("Player"),m.exports.useEffect((()=>{const e=o.velocity.subscribe((e=>{P.setState({velocity:e})})),t=o.position.subscribe((e=>{P.setState({position:e})}));return()=>{e(),t()}}),[]),p((()=>{const[t,l,s]=P.getState().velocity;e.up&&o.velocity.set(0,l+1,0),e.down&&o.velocity.set(0,l-1,0),e.right&&o.velocity.set(t+1,l,0),e.left&&o.velocity.set(t-1,l,0),o.rotation.set(0,0,M(45*C(l/10))),r.current.setRotationFromAxisAngle(n.lerp(n.set(C(.5*l),-.8,0),.25),.5),a.current.setRotationFromAxisAngle(n.lerp(n.set(-1*C(.5*l),.8,0),.25),.5)})),d.createElement("group",{ref:t},d.createElement(h,{args:[2,1,1],radius:.15,smoothness:4},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{args:[.5,.5,.9],position:[.9,-.25,0],rotation:[0,0,0],radius:.1,smoothness:4},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{args:[.5,.5,.1],position:[.25,.5,0],radius:.05,smoothness:4,rotation:[0,0,10]},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{ref:r,args:[.5,.1,.6],position:[-0,-.25,.5],radius:.05,smoothness:4},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{ref:a,args:[.5,.1,.6],position:[-0,-.25,-.5],radius:.05,smoothness:4},d.createElement("meshPhongMaterial",{attach:"material",color:(null==e?void 0:e.color)||"purple"})),d.createElement(h,{args:[.1,.1,.5],position:[1.15,-.4,0],radius:.05,smoothness:4},d.createElement("meshPhongMaterial",{attach:"material",color:"black"})),d.createElement(x,{position:[.6,.1,.5]}),d.createElement(x,{position:[.6,.1,-.5],mirror:!0}),d.createElement(S,{color:e.color}))},O=e=>{const[t]=E((()=>s({rotation:[-Math.PI/2,0,0],position:[0,-20,0]},e)));return d.createElement("mesh",{ref:t,receiveShadow:!0},d.createElement("planeBufferGeometry",{attach:"geometry",args:[1009,1e3]}),d.createElement("shadowMaterial",{attach:"material",color:"#171717"}),d.createElement("meshStandardMaterial",{color:"#4bb3fd"}))},j=e=>{const[t,o]=m.exports.useState(!1),[r,a]=m.exports.useState(!1),[n,l]=m.exports.useState(!1),[s,i]=m.exports.useState(!1);return console.log("Scene"),m.exports.useEffect((()=>{const e=e=>{38===e.keyCode||87===e.keyCode?o(!0):37===e.keyCode||65===e.keyCode?l(!0):39===e.keyCode||68===e.keyCode?i(!0):40===e.keyCode||83===e.keyCode?a(!0):e.keyCode},t=e=>{38===e.keyCode||87===e.keyCode?(console.log("up keyup"),o(!1)):37===e.keyCode||65===e.keyCode?l(!1):39===e.keyCode||68===e.keyCode?i(!1):40===e.keyCode||83===e.keyCode?a(!1):e.keyCode};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[]),d.createElement(d.Fragment,null,d.createElement("pointLight",{position:[10,10,-10],decay:10,intensity:2}),d.createElement(g,null,d.createElement(L,{color:"red",up:t,down:r,left:n,right:s}),d.createElement(O,null)))},A=f.div`
  width: 100vw;
  height: 100vh;
`,R=()=>{const e=new u;return console.log("Camera movement"),p((t=>{const[o,r,a]=P.getState().position,n=e.lerp(e.set(o,r,a),.05);t.camera.lookAt(n),t.camera.updateProjectionMatrix()})),null},I=()=>(console.log("Scene mounted"),d.createElement(A,null,d.createElement(v,{shadows:!0,colorManagement:!0,camera:{position:[4.5,-10,50],fov:35,far:300,near:.1}},d.createElement(k,{enabled:!0,target:[0,-20,0],minDistance:20,maxDistance:60}),d.createElement("ambientLight",null),d.createElement("pointLight",{position:[10,10,10]}),d.createElement(j,null),d.createElement(b,{azimuth:.1,turbidity:5,rayleigh:0,inclination:.6,sunPosition:[.1,0,-5],distance:1e4}),d.createElement(R,null))));w.render(d.createElement(d.StrictMode,null,d.createElement(I,null)),document.getElementById("root"));
