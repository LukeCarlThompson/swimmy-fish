var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,s=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,c=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&s(e,o,t[o]);if(r)for(var o of r(t))n.call(t,o)&&s(e,o,t[o]);return e},i=(e,r)=>t(e,o(r));import{c as l,u as m,r as u,V as d,a as p,R as h,b as f,S as E,C as g,d as y,M as w,O as S,P as v,e as M,D as x,f as b,g as k,s as C,h as R,E as P,i as L,j as z,k as A}from"./vendor.99104afb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const F=l(((e,t)=>({position:[0,0,0],velocity:[0,0,0],rotation:[0,0,0],mousePosition:[0,0,0],controls:{up:!1,down:!1,left:!1,right:!1,mouse:!1},isUnderWater:!0,uuid:"",cannonApi:null}))),O=e=>e*(Math.PI/180),j=e=>e/(1+Math.abs(e)),I=e=>h.createElement("meshPhysicalMaterial",{attach:"material",flatShading:!1,specular:"#eff41c",roughness:.7,reflectivity:1,metalness:1,clearcoat:1,clearcoatRoughness:.2,color:e.color||"purple"}),B=e=>{const t=u.exports.useRef(),o=u.exports.useRef(),r=u.exports.useRef();return p((e=>{const[a,n,s]=F.getState().velocity,[c,i,l]=F.getState().position,m=O(Math.sin(Math.abs(n)+Math.abs(i)+Math.abs(a)+Math.abs(c)+4*e.clock.getElapsedTime()));t.current.rotation.set(0,10*m,0),o.current.rotation.set(0,25*m,0),r.current.rotation.set(0,25*m,0)})),h.createElement("group",{ref:t},h.createElement(f,{args:[1,.75,.6],position:[-.5,.05,0],radius:.2,smoothness:4,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement("group",{ref:o,position:[-1,0,0]},h.createElement(f,{args:[.6,.6,.3],position:[-.1,0,0],radius:.05,smoothness:4,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement("group",{ref:r,position:[-.4,0,0]},h.createElement(f,{args:[.75,.4,.1],position:[-.1,.15,0],radius:.05,smoothness:4,rotation:[0,0,-10],receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement(f,{args:[.75,.4,.1],position:[-.1,-.15,0],radius:.05,smoothness:4,rotation:[0,0,10],receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})))))},G=e=>{const t=u.exports.useRef(),o=new d;return p((r=>{const[a,n,s]=F.getState().velocity,c=o.set(j(-.1*n),.1*j(-1*n)+.5,0);t.current.setRotationFromAxisAngle(c.normalize(),e.mirror?-10:.5)})),h.createElement("group",i(c({},e),{ref:t}),h.createElement(E,{position:[0,0,0],args:[.3],receiveShadow:!0,castShadow:!0},h.createElement(I,{translate:[0,10,.25],attach:"material",color:"#f3f3f3"})),h.createElement(E,{position:[0,0,.25],args:[.1],receiveShadow:!0,castShadow:!0},h.createElement(I,{translate:[0,10,.25],attach:"material",color:"black"})))},U=e=>{const[t,o]=m((()=>c({mass:1,position:[0,0,0],linearDamping:.75,linearFactor:[1,1,0],angularFactor:[1,1,0]},e))),r=u.exports.useRef(),a=u.exports.useRef(),n=new d,s=u.exports.useRef([0,0,0]),i=u.exports.useRef([0,0,0]),l=u.exports.useRef([0,0,0]);return console.log("Player"),u.exports.useLayoutEffect((()=>{F.setState({uuid:t.current.uuid}),F.setState({cannonApi:o}),console.count("subscribed");const e=o.velocity.subscribe((e=>{s.current=e})),r=o.position.subscribe((e=>{i.current=e})),a=o.rotation.subscribe((e=>{l.current=e}));return()=>{console.count("unsubscribed"),e(),r(),a()}}),[]),p((e=>{const{controls:t,isUnderWater:c}=F.getState(),[m,u,d]=s.current,[p,h]=F.getState().mousePosition,[f,E,g]=i.current;t.up&&c&&o.velocity.set(m,u+.2,d),t.down&&c&&o.velocity.set(m,u-.2,d),t.right&&c&&o.velocity.set(m+.5,u,d),t.left&&c&&o.velocity.set(m-.5,u,d),t.mouse&&c&&o.velocity.set(m+.1*p,u+.1*h,d),c&&u<-15&&o.velocity.set(m,-15,d),o.linearDamping.set(c?.75:.01),!c&&E>10.25&&o.applyImpulse([0,-.5,0],[0,0,0]),E<9&&!c&&(F.setState({isUnderWater:!0}),console.log("not underwater"));const y=-10*Math.sin(Math.abs(u)+Math.abs(E)+Math.abs(m)+Math.abs(f)+4*e.clock.getElapsedTime()),w={y:O(180*(.5*j(.5*m)-.5)+y),z:O(90*j(.2*u))};o.rotation.set(0,w.y,w.z),F.setState({rotation:l.current}),F.setState({velocity:s.current}),F.setState({position:i.current}),r.current.setRotationFromAxisAngle(n.lerp(n.set(j(1*u),-1,0),.25),.5),a.current.setRotationFromAxisAngle(n.lerp(n.set(-1*j(1*u),1,0),.25),.5)})),h.createElement("group",{ref:t},h.createElement(f,{args:[1.5,1.2,.8],position:[.25,.1,0],radius:.2,smoothness:4,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement(f,{args:[.7,.5,.8],position:[.8,-.25,0],rotation:[0,0,0],radius:.2,smoothness:6,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement(f,{args:[.5,.5,.05],position:[.25,.7,0],radius:.05,smoothness:4,rotation:[0,0,10],receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement(f,{ref:r,args:[.5,.1,.6],position:[-0,-.25,.4],radius:.05,smoothness:4,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement(f,{ref:a,args:[.5,.1,.6],position:[-0,-.25,-.4],radius:.05,smoothness:4,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:e.color})),h.createElement(f,{args:[.1,.1,.5],position:[1.11,-.3,0],radius:.05,smoothness:4,receiveShadow:!0,castShadow:!0},h.createElement(I,{color:"#2e2929"})),h.createElement(G,{position:[.6,.1,.35]}),h.createElement(G,{position:[.6,.1,-.35],mirror:!0}),h.createElement(B,{color:e.color}))},T=e=>{const t=u.exports.useRef();u.exports.useRef(Math.random());const o=u.exports.useRef(!1),r=u.exports.useRef(new g("hsl(340, 88%, 45%)")),a=u.exports.useRef(new g("hsl(220, 87%, 30%)")),n=e.size||.5,[s,i]=y((()=>c({mass:.2*n,position:e.position,linearDamping:.7,linearFactor:[1,1,0],args:n,onCollide:e=>{o.current=!o.current}},e)));return p((({clock:e})=>{o.current?(t.current.color.lerpHSL(a.current,.05),t.current.distort=1):(t.current.color.lerpHSL(r.current,.05),t.current.distort=.5)})),console.log("Ball"),h.createElement("group",{ref:s},h.createElement(E,{position:[0,0,0],args:[n],receiveShadow:!0,castShadow:!0},h.createElement(w,{attach:"material",color:"hsl(340, 88%, 60%)",metalness:1,specular:"#0068b3",roughness:.7,reflectivity:1,clearcoat:1,clearcoatRoughness:.2,ref:t})))},q=e=>h.createElement("meshPhongMaterial",{shininess:10,color:"#0f2a40"}),D=e=>(console.log("Block"),h.createElement(h.Fragment,null,h.createElement("group",null,h.createElement("mesh",i(c({},e),{scale:1,receiveShadow:!0,castShadow:!0}),h.createElement("sphereGeometry",{args:8*(.5*Math.random()+.75)}),h.createElement(q,null))))),W=e=>{const t=u.exports.useRef(Array.from(Array(20)).map((e=>[Math.random()-.5,Math.random(),Math.random()])));return h.createElement("group",null,t.current.map(((e,t)=>{const o=100*e[0],r=-100*e[1]+10,a=e[2];return h.createElement("group",{key:t},h.createElement(D,{position:[o*(Math.random()+.5),-15,r*(Math.random()+.75)],rotation:[a,a,0]}))})))},N=e=>h.createElement("meshPhongMaterial",{attach:"material",flatShading:!1,specular:"#eff41c",color:e.color||"green",transparent:!0,opacity:e.opacity||.5}),H=e=>(console.log("Pillar"),h.createElement(h.Fragment,null,h.createElement("coneGeometry",{args:[.5,15,7]}),h.createElement(N,{opacity:1,color:"#275e5c"}))),X=e=>{const t=u.exports.useRef(Array.from(Array(200)).map((e=>[Math.random()-.5,Math.random(),Math.random()]))),o=u.exports.useRef(),r=u.exports.useRef(new S),a=u.exports.useRef(t.current.map(((e,t)=>({positionX:100*e[0],positionZ:-100*e[1]+10,rotationY:e[2]}))),[]);return u.exports.useLayoutEffect((()=>{a.current.forEach(((e,t)=>{const{positionX:a,positionZ:n,rotationY:s}=e,c=.5*Math.random()+.5;r.current.position.set(a,15*c*.5-10,n>-1&&n<2?n:n-100*Math.random()),r.current.scale.set(1,c,1),r.current.rotation.set(0,s,0),r.current.updateMatrix(),o.current.setMatrixAt(t,r.current.matrix)})),o.current.instanceMatrix.needsUpdate=!0}),[]),h.createElement("instancedMesh",{ref:o,receiveShadow:!0,castShadow:!0,args:[null,null,a.current.length]},h.createElement(H,null))},Y=e=>{const[t]=M((()=>c({rotation:[-Math.PI/2,0,0],position:[0,10,0],isTrigger:!0,onCollide:e=>{const{body:t}=e,o=F.getState().uuid;t.uuid===o&&F.setState({isUnderWater:!0})}},e)));return console.log("Ceiling"),h.createElement("mesh",{ref:t},h.createElement("planeBufferGeometry",{attach:"geometry",args:[1e3,1e3]}),h.createElement("meshBasicMaterial",{attach:"material",transparent:!0,opacity:0}))},Z=e=>{const[t]=M((()=>c({rotation:[-Math.PI/-2,0,0],position:[0,10,0],isTrigger:!0,onCollide:e=>{const{body:t,contact:o}=e,r=F.getState().uuid,a=F.getState().cannonApi,{velocity:n}=F.getState();t.uuid===r&&(F.setState({isUnderWater:!1}),a.applyImpulse([.5*n[0],.25*n[1],0],[0,0,0]))}},e)));return console.log("Ceiling"),h.createElement("mesh",{ref:t},h.createElement("planeBufferGeometry",{attach:"geometry",args:[1e3,1e3]}),h.createElement("meshPhysicalMaterial",{attach:"material",flatShading:!1,specular:"#9afcec",roughness:.2,reflectivity:1,metalness:.5,clearcoat:1,clearcoatRoughness:.15,color:"#87e5ff",side:x}))},K=e=>h.createElement("mesh",{rotation:[O(0),0,0],position:[0,0,-200]},h.createElement("planeBufferGeometry",{attach:"geometry",args:[1e3,20]}),h.createElement("meshPhongMaterial",{shininess:100,color:"#356375"})),V=e=>{const[t]=M((()=>c({rotation:[-Math.PI/2,0,0],position:[0,-10,0]},e)));return h.createElement("mesh",{ref:t,receiveShadow:!0},h.createElement("planeBufferGeometry",{attach:"geometry",args:[1e3,1e3]}),h.createElement("meshPhongMaterial",{shininess:10,color:"#0f2a40"}))},J=e=>(console.log("Scene"),h.createElement(h.Fragment,null,h.createElement(v,{gravity:[0,0,0],iterations:20,defaultContactMaterial:{friction:.9,restitution:.7,contactEquationStiffness:1e7,contactEquationRelaxation:1,frictionEquationStiffness:1e7,frictionEquationRelaxation:2},tolerance:.001},h.createElement(Y,null),h.createElement(Z,null),h.createElement(U,{color:"#e07e28"}),h.createElement(T,{position:[5,0,0],size:.75}),h.createElement(T,{position:[6,2,0],size:.25}),h.createElement(T,{position:[6,2,0],size:.25}),h.createElement(T,{position:[6,2,0],size:.25}),h.createElement(T,{position:[6,2,0],size:.2}),h.createElement(T,{position:[6,2,0],size:.15}),h.createElement(T,{position:[6,2,0],size:.35}),h.createElement(T,{position:[6,2,0],size:.25}),h.createElement(T,{position:[-2,-5,0]}),h.createElement(T,{position:[-3,-3,0],size:1.2}),h.createElement(T,{position:[-7,-5,0],size:.8}),h.createElement(W,null),h.createElement(X,null),h.createElement(K,null),h.createElement(V,null)))),Q=e=>(console.log("Controls"),u.exports.useEffect((()=>{const e=e=>{38===e.keyCode||87===e.keyCode||32===e.keyCode?F.setState({controls:{up:!0}}):37===e.keyCode||65===e.keyCode?F.setState({controls:{left:!0}}):39===e.keyCode||68===e.keyCode?F.setState({controls:{right:!0}}):40===e.keyCode||83===e.keyCode?F.setState({controls:{down:!0}}):e.keyCode},t=e=>{38===e.keyCode||87===e.keyCode||32===e.keyCode?F.setState({controls:{up:!1}}):37===e.keyCode||65===e.keyCode?F.setState({controls:{left:!1}}):39===e.keyCode||68===e.keyCode?F.setState({controls:{right:!1}}):40===e.keyCode||83===e.keyCode?F.setState({controls:{down:!1}}):e.keyCode},o=()=>{F.setState({controls:{mouse:!0}})},r=()=>{F.setState({controls:{mouse:!1}})};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),window.addEventListener("mousedown",o),window.addEventListener("mouseup",r),window.addEventListener("touchstart",o),window.addEventListener("touchend",r),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),window.removeEventListener("mousedown",o),window.removeEventListener("mouseup",r),window.removeEventListener("touchstart",o),window.removeEventListener("touchend",r)}}),[]),p((e=>{const{mouse:t,viewport:o}=e,r=t.x*o.width/2,a=t.y*o.height/2;F.setState({mousePosition:[r,a,0]})})),null),$=()=>(console.log("lighting"),h.createElement(h.Fragment,null,h.createElement("ambientLight",{intensity:.3,color:"#bfefff"}),h.createElement("spotLight",{position:[0,200,-300],angle:.2,intensity:2,distance:700,decay:3,penumbra:1,color:"#fffb8a",castShadow:!0,"shadow-mapSize-height":2048,"shadow-mapSize-width":2048}),h.createElement(b,{penumbra:.5,position:[50,150,-50],intensity:1,distance:200,angle:.8,attenuation:200,anglePower:10,color:"#fffb8a"})));function _({count:e,mouse:t}){const o=u.exports.useRef(),{size:r,viewport:a}=k();r.width,a.width;const n=u.exports.useMemo((()=>new S),[]),s=u.exports.useMemo((()=>{const t=[];for(let o=0;o<e;o++){const e=100*Math.random(),o=10+Math.random(),r=.01,a=200*Math.random()-100,n=50*Math.random()-20,s=150*Math.random()-100;t.push({t:e,factor:o,speed:r,xFactor:a,yFactor:n,zFactor:s,mx:0,my:0})}return t}),[e]);return p((e=>{F.getState().velocity,s.forEach(((t,r)=>{let{t:a,factor:s,speed:c,xFactor:i,yFactor:l,zFactor:m}=t;a=t.t+=.5*c;const u=Math.cos(a);t.mx+=.001*(0-t.mx),t.my+=.001*(-0-t.my),n.position.set(t.mx/10*1+i+Math.cos(.05*e.clock.elapsedTime)+10*Math.sin(.05*e.clock.elapsedTime),t.my/10+l+Math.sin(.01*a*s)+Math.cos(.5*a)*s/10,m),n.rotation.set(5*u,5*u,5*u),n.updateMatrix(),o.current.setMatrixAt(r,n.matrix)})),o.current.instanceMatrix.needsUpdate=!0})),h.createElement(h.Fragment,null,h.createElement("instancedMesh",{ref:o,args:[null,null,e]},h.createElement("planeGeometry",{args:[.2,.1]}),h.createElement("meshPhongMaterial",{color:"#8ff8ff"})))}const ee=C.div`
  width: 100vw;
  height: 100vh;
  user-select: none;
`,te=()=>(console.log("Camera movement"),p((e=>{const[t,o,r]=F.getState().position,[a,n,s]=F.getState().velocity,c=t+.1*a,i=o+.1*n;e.camera.lookAt(c,i,0),e.camera.position.y=i>11?11:i>-9?i:-9,e.camera.position.x=c,e.camera.position.z=20,e.camera.updateProjectionMatrix()})),null),oe=()=>(console.log("Scene mounted"),h.createElement(ee,null,h.createElement(R,{shadows:!0,shadowMap:!0,colorManagement:!0,camera:{position:[0,0,20],fov:45,far:300,near:.1}},h.createElement(u.exports.Suspense,{fallback:null},h.createElement(P,{preset:"forest"})),h.createElement(u.exports.Suspense,{fallback:null},h.createElement($,null),h.createElement(J,null),h.createElement(L,{azimuth:0,turbidity:5,rayleigh:0,inclination:.8,sunPosition:[.1,5,-5],distance:1e4}),h.createElement(_,{count:1e3,mouse:{current:[0,0]}})),h.createElement("fog",{attach:"fog",args:["#34d1a2",0,200]}),h.createElement(te,null),h.createElement(Q,null),h.createElement(z,{showPanel:0,className:"stats"}))));A.render(h.createElement(h.StrictMode,null,h.createElement(oe,null)),document.getElementById("root"));
