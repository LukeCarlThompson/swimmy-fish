var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,i=(e,t)=>{for(var o in t||(t={}))n.call(t,o)&&s(e,o,t[o]);if(r)for(var o of r(t))a.call(t,o)&&s(e,o,t[o]);return e};import{c as l,u as c,r as m,V as u,a as p,R as d,b as E,S as g,d as h,P as y,e as f,f as v,x as w,B as b,s as k,g as S,C as x,h as L,i as M,j as C}from"./vendor.3fd4759f.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const P=l((e=>({position:[0,0,0],velocity:[0,0,0],rotation:[0,0,0],mousePosition:[0,0,0]}))),z=e=>e*(Math.PI/180),R=e=>e/(1+Math.abs(e)),O=e=>d.createElement("meshPhongMaterial",{attach:"material",flatShading:!1,specular:"#eff41c",color:e.color||"purple"}),F=e=>{const t=m.exports.useRef(),o=m.exports.useRef(),r=m.exports.useRef();return p((e=>{const[n,a,s]=P.getState().velocity,[i,l,c]=P.getState().position,m=z(Math.sin(Math.abs(a)+Math.abs(l)+Math.abs(n)+Math.abs(i)+4*e.clock.getElapsedTime()));t.current.rotation.set(0,10*m,0),o.current.rotation.set(0,25*m,0),r.current.rotation.set(0,25*m,0)})),d.createElement("group",{ref:t},d.createElement(E,{args:[1,.75,.6],position:[-.5,.05,0],radius:.2,smoothness:4},d.createElement(O,{color:e.color})),d.createElement("group",{ref:o,position:[-1,0,0]},d.createElement(E,{args:[.6,.6,.3],position:[-.1,0,0],radius:.05,smoothness:4},d.createElement(O,{color:e.color})),d.createElement("group",{ref:r,position:[-.4,0,0]},d.createElement(E,{args:[.75,.4,.1],position:[-.1,.15,0],radius:.05,smoothness:4,rotation:[0,0,-10]},d.createElement(O,{color:e.color})),d.createElement(E,{args:[.75,.4,.1],position:[-.1,-.15,0],radius:.05,smoothness:4,rotation:[0,0,10]},d.createElement(O,{color:e.color})))))},j=e=>{const r=m.exports.useRef(),n=new u;return p((t=>{const[o,a,s]=P.getState().velocity,i=n.lerp(n.set(R(-.1*a),.1*R(-1*a)+.5,0),.25);r.current.setRotationFromAxisAngle(i.normalize(),e.mirror?-10:.5)})),d.createElement("group",(a=i({},e),t(a,o({ref:r}))),d.createElement(g,{position:[0,0,0],args:[.3]},d.createElement(O,{translate:[0,10,.25],attach:"material",color:"#f3f3f3"})),d.createElement(g,{position:[0,0,.25],args:[.1]},d.createElement(O,{translate:[0,10,.25],attach:"material",color:"black"})));var a},A=e=>{const[t,o]=c((()=>i({mass:1,position:[0,0,0],linearDamping:.5,linearFactor:[1,1,0],angularFactor:[1,1,0]},e))),r=m.exports.useRef(),n=m.exports.useRef(),a=new u;return console.log("Player"),m.exports.useEffect((()=>{const e=o.velocity.subscribe((e=>{P.setState({velocity:e})})),t=o.position.subscribe((e=>{P.setState({position:e})})),r=o.rotation.subscribe((e=>{P.setState({rotation:e})}));return()=>{console.log("unsubscribed"),e(),t(),r()}}),[]),p((t=>{const[s,i,l]=P.getState().velocity,[c,m]=P.getState().mousePosition,[u,p,d]=P.getState().position;e.up&&o.velocity.set(s,i+.2,l),e.down&&o.velocity.set(s,i-.2,l),e.right&&o.velocity.set(s+.5,i,l),e.left&&o.velocity.set(s-.5,i,l),e.applyForce&&o.velocity.set(s+.1*c,i+.1*m,l);const E=-10*Math.sin(Math.abs(i)+Math.abs(p)+Math.abs(s)+Math.abs(u)+4*t.clock.getElapsedTime()),g=a.lerp(a.set(0,z(180*(.5*R(.2*s)-.5)+E),z(90*R(.2*i))),.1);o.rotation.set(0,g.y,g.z),r.current.setRotationFromAxisAngle(a.lerp(a.set(R(1*i),-1,0),.25),.5),n.current.setRotationFromAxisAngle(a.lerp(a.set(-1*R(1*i),1,0),.25),.5)})),d.createElement("group",{ref:t},d.createElement(E,{args:[1.5,1.2,.8],position:[.25,.1,0],radius:.2,smoothness:4},d.createElement(O,{color:e.color})),d.createElement(E,{args:[.7,.5,.8],position:[.8,-.25,0],rotation:[0,0,0],radius:.1,smoothness:6},d.createElement(O,{color:e.color})),d.createElement(E,{args:[.5,.5,.05],position:[.25,.7,0],radius:.05,smoothness:4,rotation:[0,0,10]},d.createElement(O,{color:e.color})),d.createElement(E,{ref:r,args:[.5,.1,.6],position:[-0,-.25,.4],radius:.05,smoothness:4},d.createElement(O,{color:e.color})),d.createElement(E,{ref:n,args:[.5,.1,.6],position:[-0,-.25,-.4],radius:.05,smoothness:4},d.createElement(O,{color:e.color})),d.createElement(E,{args:[.1,.1,.5],position:[1.15,-.4,0],radius:.05,smoothness:4},d.createElement("meshPhysicalMaterial",{attach:"material",color:"black"})),d.createElement(j,{position:[.6,.1,.35]}),d.createElement(j,{position:[.6,.1,-.35],mirror:!0}),d.createElement(F,{color:e.color}))},I=e=>d.createElement("meshPhongMaterial",{attach:"material",flatShading:!1,specular:"#eff41c",color:e.color||"purple"}),N=e=>{const t=e.size||.5,[o,r]=h((()=>i({mass:.2*t,position:e.position,linearDamping:.9,linearFactor:[1,1,0],args:t},e)));return console.log("Ball"),d.createElement("group",{ref:o},d.createElement(g,{position:[0,0,0],args:[t]},d.createElement(I,{translate:[0,0,0],attach:"material",color:"pink"})))},B=e=>{const[t]=f((()=>i({rotation:[-Math.PI/2,0,0],position:[0,-10,0]},e)));return d.createElement("mesh",{ref:t,receiveShadow:!0},d.createElement("planeBufferGeometry",{attach:"geometry",args:[1e3,1e3]}),d.createElement("shadowMaterial",{attach:"material",color:"#171717"}),d.createElement("meshStandardMaterial",{color:"#615637"}))},D=e=>{const[t,o]=m.exports.useState(!1),[r,n]=m.exports.useState(!1),[a,s]=m.exports.useState(!1),[i,l]=m.exports.useState(!1),[c,u]=m.exports.useState(!1),E=m.exports.useRef([0,0,0]);return m.exports.useState([0,-10,0]),console.log("Scene"),m.exports.useEffect((()=>{const e=e=>{38===e.keyCode||87===e.keyCode||32===e.keyCode?o(!0):37===e.keyCode||65===e.keyCode?s(!0):39===e.keyCode||68===e.keyCode?l(!0):40===e.keyCode||83===e.keyCode?n(!0):e.keyCode},t=e=>{38===e.keyCode||87===e.keyCode||32===e.keyCode?(console.log("up keyup"),o(!1)):37===e.keyCode||65===e.keyCode?s(!1):39===e.keyCode||68===e.keyCode?l(!1):40===e.keyCode||83===e.keyCode?n(!1):e.keyCode},r=()=>{u(!0)},a=()=>{u(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),window.addEventListener("mousedown",r),window.addEventListener("mouseup",a),window.addEventListener("touchstart",r),window.addEventListener("touchend",a),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),window.removeEventListener("mousedown",r),window.removeEventListener("mouseup",a),window.removeEventListener("touchstart",r),window.removeEventListener("touchend",a)}}),[]),p((e=>{const{mouse:t,viewport:o}=e,r=t.x*o.width/2,n=t.y*o.height/2;E.current=[r,n,0],P.setState({mousePosition:[r,n,0]})})),d.createElement(d.Fragment,null,d.createElement("pointLight",{position:[10,10,-10],decay:10,intensity:2}),d.createElement(y,{gravity:[0,0,0],tolerance:.1},d.createElement(A,{color:"#e65b05",up:t,down:r,left:a,right:i,applyForce:c}),d.createElement(N,{position:[5,0,0],size:.75}),d.createElement(N,{position:[6,2,0],size:.25}),d.createElement(N,{position:[6,2,0],size:.25}),d.createElement(N,{position:[6,2,0],size:.25}),d.createElement(N,{position:[6,2,0],size:.2}),d.createElement(N,{position:[6,2,0],size:.15}),d.createElement(N,{position:[6,2,0],size:.35}),d.createElement(N,{position:[6,2,0],size:.25}),d.createElement(N,{position:[-2,-5,0]}),d.createElement(N,{position:[-3,-3,0],size:1.2}),d.createElement(N,{position:[-7,-5,0],size:.8}),d.createElement(B,null)))},G=()=>{const e=m.exports.useRef();return p((e=>{})),d.createElement(v,null,d.createElement(w,{blendFunction:b.NORMAL,adaptive:!1,resolution:256,middleGrey:3,maxLuminance:15,averageLuminance:.1,adaptationRate:.5}),d.createElement(k,{ref:e,focusDistance:.05,focalLength:.3,bokehScale:2,height:480}))},T=S.div`
  width: 100vw;
  height: 100vh;
  user-select: none;
`,q=()=>(console.log("Camera movement"),p((e=>{const[t,o,r]=P.getState().position,[n,a,s]=P.getState().velocity,i=t+.1*n,l=o+.1*a;e.camera.lookAt(i,.65*l,0),e.camera.position.y=.25*l,e.camera.position.x=i,e.camera.position.z=20,e.camera.updateProjectionMatrix()})),null),K=()=>(console.log("Scene mounted"),d.createElement(T,null,d.createElement(x,{shadows:!0,colorManagement:!0,camera:{position:[0,0,20],fov:45,far:300,near:.1}},d.createElement("ambientLight",{intensity:.75}),d.createElement("pointLight",{position:[0,100,-20]}),d.createElement(D,null),d.createElement(L,{azimuth:0,turbidity:5,rayleigh:0,inclination:.8,sunPosition:[.1,10,-5],distance:1e4}),d.createElement("fog",{attach:"fog",args:["#547f91",10,200]}),d.createElement(q,null),d.createElement(G,null),d.createElement(M,{showPanel:0,className:"stats"}))));C.render(d.createElement(d.StrictMode,null,d.createElement(K,null)),document.getElementById("root"));
